<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Área do Moderador</title>
    <link rel="stylesheet" href="/static/css/area_moderacao.css">
    <style>
        /* Estilo básico para o modal */
        .modal {
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close:hover,
        .close:focus {
            color: black;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header>
        <h1>Área do Moderador</h1>
    </header>
    
    <nav class="menustrip">
        <ul>
            <li><a href="{{ url_for('moderador_dashboard', view='pendentes') }}" {% if view == 'pendentes' %}class="active"{% endif %}>Eventos Pendentes de Aprovação</a></li>
            <li><a href="{{ url_for('moderador_dashboard', view='finalizar') }}" {% if view == 'finalizar' %}class="active"{% endif %}>Eventos para Finalizar</a></li>
        </ul>
    </nav>
    
    <main>
        {% if view == 'pendentes' %}
        <section class="pending-approval">
            <h2>Eventos Pendentes de Aprovação</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Título</th>
                        <th>Descrição</th>
                        <th>Valor da Cota</th>
                        <th>Data do Evento</th>
                        <th>Período de Apostas</th>
                        <th>ID Criador</th>
                        <th>Data de Criação</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for evento in eventos %}
                    <tr id="event-{{ evento.id }}">
                        <td>{{ evento.id }}</td>
                        <td>{{ evento.titulo }}</td>
                        <td>{{ evento.descricao }}</td>
                        <td>{{ evento.valor_cota }}</td>
                        <td>{{ evento.data_evento }}</td>
                        <td>{{ evento.periodo_apostas }}</td>
                        <td>{{ evento.id_criador }}</td>
                        <td>{{ evento.data_criacao }}</td>
                        <td>
                            <button type="button" onclick="handleEventAction('{{ evento.id }}', 'aprovar')" class="approve-btn">Aprovar</button>
                            <button type="button" onclick="abrirModalReprovar('{{ evento.id }}')" class="reject-btn">Reprovar</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
        {% elif view == 'finalizar' %}
        <section class="events-to-finalize">
            <h2>Eventos para Finalizar</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Título</th>
                        <th>Descrição</th>
                        <th>Valor da Cota</th>
                        <th>Data do Evento</th>
                        <th>Período de Apostas</th>
                        <th>ID Criador</th>
                        <th>Data de Criação</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for evento in eventos %}
                    <tr id="event-{{ evento.id }}">
                        <td>{{ evento.id }}</td>
                        <td>{{ evento.titulo }}</td>
                        <td>{{ evento.descricao }}</td>
                        <td>{{ evento.valor_cota }}</td>
                        <td>{{ evento.data_evento }}</td>
                        <td>{{ evento.periodo_apostas }}</td>
                        <td>{{ evento.id_criador }}</td>
                        <td>{{ evento.data_criacao }}</td>
                        <td>
                            <button type="button" onclick="handleEventAction('{{ evento.id }}', 'confirmar')" class="confirm-btn">Confirmar Ocorrência</button>
                            <button type="button" onclick="handleEventAction('{{ evento.id }}', 'nao_ocorrido')" class="not-occurred-btn">Não Ocorrido</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
        {% endif %}

        <!-- Modal para justificar a reprovação -->
        <div id="modalReprovar" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Justificar Reprovação</h2>
                <form id="formReprovarEvento" method="POST" action="/acao_evento">
                    <input type="hidden" name="evento_id" id="modalEventoId">
                    <input type="hidden" name="acao" value="reprovar">
                    
                    <label for="motivo_rejeicao">Reprovado por:</label>
                    <select name="motivo_rejeicao" id="modalMotivoRejeicao" required>
                        <option value="texto confuso">Texto confuso</option>
                        <option value="texto inapropriado">Texto inapropriado</option>
                        <option value="não respeita a política de privacidade e/ou termos de uso da plataforma">
                            Não respeita a política de privacidade e/ou termos de uso da plataforma
                        </option>
                    </select>

                    <label for="mensagem_rejeicao">Mensagem:</label>
                    <textarea name="mensagem_rejeicao" id="modalMensagemRejeicao" rows="4" required></textarea>

                    <button type="submit">Confirmar Reprovação</button>
                </form>
            </div>
        </div>
    </main>

    <script src="/static/js/area_moderador.js"></script>
</body>
</html>
